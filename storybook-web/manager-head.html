<script>
  const updateColors = (isDark) => {
    console.log({ isDark })
    const styles = document.getElementById('ds-styles-manager');

    styles.innerHTML = `
    .sidebar-header a:after {
      content: 'DS React Native';
      color: ${isDark ? 'white' : '#333333'};
      display: block;
      text-align: center;
    }
  `
  }
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
    console.log({ e })
    updateColors(e.matches)
  });
  window.onload = () => updateColors(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches)
  window.addEventListener('CHANGE_THEME', (e) => {
    setTimeout(() => {
      const store = localStorage.getItem('@storybook/ui/store');
      const initialTheme = store && JSON.parse(store);
      const { theme } = initialTheme;
      updateColors(theme.base === 'dark')
    }, 200);
  })
</script>

<style id="ds-styles-manager"></style>
<link rel="shortcut icon" href="/favicon.png" />



<style>
  #ds-info-wrapper {
    position: absolute;
    right: 15px;
    top: 15px;
    z-index: 1;
  }

  #ds-info-open {
    background-color: transparent;
    color: #f66a0d;
    border: none;
    padding: 10px;
    font-family: "Nunito Sans", -apple-system, ".SFNSText-Regular", "San Francisco", BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 12px;
    font-weight: 600;
  }

  #ds-info-content {
    background-color: white;
    padding: 15px;
    color: black;
    box-shadow: rgba(0, 0, 0, 0.10) 0 1px 3px 0;
    position: absolute;
    left: -400px;
    right: -5px;
    border: 1px solid #eaeaea;
  }

  .hidden {
    display: none;
  }
</style>
<script>
  const writeBuildInfo = (buildInfo) => {
    var infoWrapper = document.getElementById('ds-info-content')
    infoWrapper.innerHTML = `
      <pre>${JSON.stringify(buildInfo, null, 2)}</pre>
    `
  }

  var toggleInfo = () => {
    var info = document.getElementById('ds-info-content')
    info.classList.toggle('hidden')
    const isLocal = location.host.includes('localhost')
    const haveInfo = window.dsBuildInfo

    if (!isLocal) {
      if (!haveInfo) {
        fetch('./buildInfo.json')
          .then(async res => {
            const buildInfo = await res.json();
            console.log(buildInfo)
            window.dsBuildInfo = buildInfo
            writeBuildInfo(buildInfo)
          })
          .catch(err => console.error(err));
      }
    }
  }
</script>
<div id="ds-info-wrapper">
  <button id="ds-info-open" type="button" onclick="toggleInfo()">View version info</button>
  <div id="ds-info-content" class="hidden">
  </div>
</div>
